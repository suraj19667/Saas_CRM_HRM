{% extends 'base.html' %}
{% load static %}
{% block content %}
{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="content-header">
    <h1>Orders</h1>
    <p class="text-muted">Subscriptions and Orders</p>
</div>

<div class="card">
    <div class="card-body">
        <table class="table table-hover table-responsive">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Company</th>
                    <th>Plan</th>
                    <th>Tenant ID</th>
                    <th>Plan ID</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Billing Cycle</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Created At</th>
                    <th>Updated At</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% if subscriptions and subscriptions|length > 0 %}
                {% for subscription in subscriptions %}
                <tr>
                    <td>{{ subscription.id }}</td>
                    <td>{{ subscription.tenant.name }}</td>
                    <td>{% if subscription.plan %}{{ subscription.plan.name }}{% else %}-{% endif %}</td>
                    <td>{{ subscription.tenant.id }}</td>
                    <td>{% if subscription.plan %}{{ subscription.plan.id }}{% else %}-{% endif %}</td>
                    <td>{% if subscription.start_date %}{{ subscription.start_date|date:"Y-m-d" }}{% else %}-{% endif %}
                    </td>
                    <td>{% if subscription.end_date %}{{ subscription.end_date|date:"Y-m-d" }}{% else %}-{% endif %}
                    </td>
                    <td>{{ subscription.billing_cycle }}</td>
                    <td>{{ subscription.amount }}</td>
                    <td>{{ subscription.status }}</td>
                    <td>{% if subscription.created_at %}{{ subscription.created_at|date:"Y-m-d H:i" }}{% else %}-{%
                        endif %}</td>
                    <td>{% if subscription.updated_at %}{{ subscription.updated_at|date:"Y-m-d H:i" }}{% else %}-{%
                        endif %}</td>
                    <td><a class="btn btn-sm btn-primary"
                            href="{% url 'payment:subscription_detail' subscription.id %}">View</a></td>
                </tr>
                {% endfor %}
                {% elif tenants and tenants|length > 0 %}
                {% for tenant in tenants %}
                <tr>
                    <td>-</td>
                    <td>{{ tenant.name }}</td>
                    <td>{% if tenant.subscription_plan %}{{ tenant.subscription_plan.name }}{% else %}-{% endif %}</td>
                    <td>{{ tenant.id }}</td>
                    <td>{% if tenant.subscription_plan %}{{ tenant.subscription_plan.id }}{% else %}-{% endif %}</td>
                    <td>{% if tenant.subscription_start_date %}{{ tenant.subscription_start_date|date:"Y-m-d" }}{% else
                        %}-{% endif %}</td>
                    <td>{% if tenant.subscription_end_date %}{{ tenant.subscription_end_date|date:"Y-m-d" }}{% else
                        %}-{% endif %}</td>
                    <td>{% if tenant.subscription_plan %}monthly{% else %}-{% endif %}</td>
                    <td>{% if tenant.subscription_plan %}{{ tenant.subscription_plan.price_monthly }}{% else %}-{% endif
                        %}</td>
                    <td>{% if tenant.status == 'active' %}active{% else %}-{% endif %}</td>
                    <td>-</td>
                    <td>-</td>
                    <td><a class="btn btn-sm btn-primary" href="{% url 'payment:order_detail' tenant.id %}">View</a>
                    </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="13">No subscriptions found.</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
{% endif %}
</tbody>
</table>
</div>
</div>
{% endblock %}